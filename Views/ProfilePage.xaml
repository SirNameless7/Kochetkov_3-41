<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:KPO_Cursovoy.ViewModels"
             x:Class="KPO_Cursovoy.Views.ProfilePage"
             x:DataType="vm:ProfileViewModel"
             Title="Профиль"
             BackgroundColor="#020617">

    <ScrollView>
        <VerticalStackLayout Padding="15" Spacing="20">

            <Frame Padding="0"
                   BorderColor="#3B82F6"
                   CornerRadius="100"
                   HeightRequest="120"
                   WidthRequest="120"
                   HorizontalOptions="Center"
                   Margin="0,20,0,10">
                <Grid>
                    <Ellipse Fill="#3B82F6">
                        <Ellipse.Stroke>
                            <SolidColorBrush Color="#2563EB" />
                        </Ellipse.Stroke>
                    </Ellipse>

                    <Label Text="{Binding Initials}"
                           FontSize="40"
                           TextColor="White"
                           HorizontalTextAlignment="Center"
                           VerticalTextAlignment="Center" />
                </Grid>
            </Frame>

            <Label Text="{Binding FullName}"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="#F9FAFB" />

            <Label Text="{Binding Phone, StringFormat='Телефон: {0}'}"
                   TextColor="#9CA3AF"
                   HorizontalOptions="Center" />

            <Label Text="{Binding LoyaltyStatus, StringFormat='Статус: {0}'}"
                   TextColor="#10B981"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />

            <Grid ColumnDefinitions="*,*"
                  RowDefinitions="Auto,Auto"
                  ColumnSpacing="15"
                  Margin="0,20,0,0">

                <Frame Padding="15"
                       BorderColor="#E2E8F0"
                       CornerRadius="12">
                    <VerticalStackLayout>
                        <Label Text="Заказы"
                               TextColor="#64748B"
                               FontSize="14" />
                        <Label Text="{Binding OrderCount}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="#3B82F6"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="15"
                       BorderColor="#E2E8F0"
                       CornerRadius="12"
                       Grid.Column="1">
                    <VerticalStackLayout>
                        <Label Text="Скидка"
                               TextColor="#64748B"
                               FontSize="14" />
                        <Label Text="{Binding DiscountPercent, StringFormat='{0}%'}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="#10B981"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="15"
                       BorderColor="#E2E8F0"
                       CornerRadius="12"
                       Grid.Row="1">
                    <VerticalStackLayout>
                        <Label Text="Потрачено"
                               TextColor="#64748B"
                               FontSize="14" />
                        <Label Text="{Binding TotalSpent, StringFormat='₽{0:F2}'}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="#9333EA"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="15"
                       BorderColor="#E2E8F0"
                       CornerRadius="12"
                       Grid.Row="1"
                       Grid.Column="1">
                    <VerticalStackLayout>
                        <Label Text="Последний визит"
                               TextColor="#64748B"
                               FontSize="14" />
                        <Label Text="{Binding LastVisit, StringFormat='{0:d}', TargetNullValue='—'}"
                               FontSize="28"
                               FontAttributes="Bold"
                               TextColor="#F59E0B"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <Frame Padding="15"
                   BorderColor="#E2E8F0"
                   CornerRadius="12"
                   Margin="0,10,0,0">
                <VerticalStackLayout Spacing="15">
                    <Button Text="История заказов"
                            Command="{Binding ViewOrdersCommand}"
                            BackgroundColor="White"
                            TextColor="#3B82F6"
                            BorderColor="#3B82F6"
                            BorderWidth="1"
                            CornerRadius="12"
                            HorizontalOptions="Fill" />

                    <Button Text="Настройки аккаунта"
                            Command="{Binding SettingsCommand}"
                            BackgroundColor="White"
                            TextColor="#3B82F6"
                            BorderColor="#3B82F6"
                            BorderWidth="1"
                            CornerRadius="12"
                            HorizontalOptions="Fill" />

                    <Button Text="Техническая поддержка"
                            Command="{Binding SupportCommand}"
                            BackgroundColor="White"
                            TextColor="#3B82F6"
                            BorderColor="#3B82F6"
                            BorderWidth="1"
                            CornerRadius="12"
                            HorizontalOptions="Fill" />

                    <Button Text="Выйти из аккаунта"
                            Command="{Binding LogoutCommand}"
                            BackgroundColor="#EF4444"
                            TextColor="White"
                            CornerRadius="12"
                            HorizontalOptions="Fill" />
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
